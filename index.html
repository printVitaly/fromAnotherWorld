<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Игра в Блэкджек</title>
    <style>
        body, html {
            font-family: 'Arial', sans-serif;
            text-align: center;
            background-color: #eee;
            margin: 0;
            padding: 0;
        }
        #menu, #gameArea {
            padding: 20px;
        }
        button {
            margin: 5px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
        #dealerCards, #playerCards {
            display: flex;
            justify-content: center;
            margin: 10px 0;
        }
        .card {
            width: 60px;
            height: 90px;
            background-color: #fff;
            border-radius: 8px;
            border: 1px solid #000;
            margin: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }
        .red { color: red; }
        .black { color: black; }
        h2, h1 {
            color: #333;
        }
    </style>
</head>
<body>
    <div id="menu">
        <h1>Блэкджек</h1>
        <div>Ваши монеты: <span id="coins">1000</span></div>
        <button onclick="startGame()">Start Game</button>
        <button onclick="addFunds()">Add Funds</button>
        <button onclick="showLeaderboard()">Top Players</button>
        <button onclick="showRules()">Правила</button>
    </div>
    <div id="gameArea" style="display:none;">
        <div id="dealerArea">
            <h2>Карты дилера</h2>
            <div id="dealerCards"></div>
        </div>
        <div id="playerArea">
            <h2>Ваши карты</h2>
            <div id="playerCards"></div>
        </div>
        <button onclick="hit()">Hit</button>
        <button onclick="stand()">Stand</button>
        <h2>Ваш счет: <span id="playerScore"></span></h2>
        <div id="result"></div>
    </div>
    <script>
        let coins = 1000;
        let dealerCards = [];
        let playerCards = [];
        let deck = [];
        let playerScore = 0;

        function startGame() {
            document.getElementById('menu').style.display = 'none';
            document.getElementById('gameArea').style.display = 'block';
            deck = createDeck();
            shuffleDeck(deck);
            dealerCards = [drawCard(), drawCard()];
            playerCards = [drawCard(), drawCard()];
            renderCards();
            updateScores();
        }

        function addFunds() {
            coins += 1000;
            document.getElementById('coins').innerText = coins;
        }

        function showLeaderboard() {
            alert("Функционал лидеров не реализован.");
        }

        function showRules() {
            alert("Игрок и дилер получают по две карты. Цель игры - набрать 21 очко или близкое к этому число, не превышая его. Карты 'J', 'Q', 'K' стоят 10 очков, туз может стоить 1 или 11 очков, остальные карты соответствуют своему номиналу.");
        }

        function hit() {
            playerCards.push(drawCard());
            renderCards();
            updateScores();
            checkGameEnd();
        }

        function stand() {
            dealerTurn();
        }

        function dealerTurn() {
            while (getTotal(dealerCards) < 17) {
                dealerCards.push(drawCard());
                renderCards();
                updateScores();
                checkGameEnd();
            }
        }

        function getTotal(cards) {
            let total = 0;
            let aceCount = 0;
            cards.forEach(card => {
                if (card.rank === 'A') {
                    aceCount++;
                    total += 11;
                } else if (['J', 'Q', 'K'].includes(card.rank)) {
                    total += 10;
                } else {
                    total += parseInt(card.rank);
                }
            });
            while (total > 21 && aceCount > 0) {
                total -= 10;
                aceCount--;
            }
            return total;
        }

        function drawCard() {
            return deck.pop();
        }

        function createDeck() {
            const suits = ['Hearts', 'Diamonds', 'Clubs', 'Spades'];
            const ranks = [2, 3, 4, 5, 6, 7, 8, 9, 10, 'J', 'Q', 'K', 'A'];
            const newDeck = [];
            suits.forEach(suit => {
                ranks.forEach(rank => {
                    let color = (suit === 'Hearts' || suit === 'Diamonds') ? 'red' : 'black';
                    newDeck.push({ suit, rank, color });
                });
            });
            return newDeck;
        }

        function shuffleDeck(deck) {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
        }

        function renderCards() {
            const dealerDiv = document.getElementById('dealerCards');
            dealerDiv.innerHTML = '<div class="card black" style="visibility: hidden;">' + dealerCards[1].rank + '</div><div class="card ' + dealerCards[0].color + '">' + dealerCards[0].rank + ' of ' + dealerCards[0].suit + '</div>';
            const playerDiv = document.getElementById('playerCards');
            playerDiv.innerHTML = '';
            playerCards.forEach(card => {
                playerDiv.innerHTML += '<div class="card ' + card.color + '">' + card.rank + ' of ' + card.suit + '</div>';
            });
        }

        function updateScores() {
            playerScore = getTotal(playerCards);
            document.getElementById('playerScore').innerText = playerScore;
        }

        function checkGameEnd() {
            const playerTotal = getTotal(playerCards);
            const dealerTotal = getTotal(dealerCards);
            const resultDiv = document.getElementById('result');
            if (playerTotal > 21) {
                resultDiv.innerText = 'Перебор! Вы проиграли.';
            } else if (dealerTotal > 21) {
                resultDiv.innerText = 'Перебор у дилера! Вы выиграли.';
            } else if (playerTotal === 21 && playerCards.length === 2) {
                resultDiv.innerText = 'Блэкджек! Вы выиграли.';
            } else if (dealerTotal === 21 && dealerCards.length === 2) {
                resultDiv.innerText = 'Блэкджек у дилера! Вы проиграли.';
            }
        }
    </script>
</body>
</html>
